<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>DSAN-5000: Project - EDA</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
.image-container {
        display: flex;
        flex-direction: column;
        gap: 20px;
        align-items: center;
    }
    
.distribution-image {
        width: 800px;  
        height: auto;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../assets/gu-logo.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">DSAN-5000: Project</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../instructions/overview.html"> 
<span class="menu-text">Instructions</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../collaborators.html"> 
<span class="menu-text">Collaborators</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../report/report.html"> 
<span class="menu-text">Report</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-technical-details" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Technical details</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-technical-details">    
        <li>
          <a class="dropdown-item" href="../../technical-details/data-collection/main.html">
            <span class="dropdown-text">Data-collection</span></a>
            <a class="dropdown-item" href="../../technical-details/data-cleaning/main.html">
             <span class="dropdown-text">Data-cleaning</span></a>
             <a class="dropdown-item" href="../../technical-details/unsupervised-learning/main.html">
              <span class="dropdown-text">Unsupervised-learning</span></a>
              <a class="dropdown-item" href="../../technical-details/eda/main.html">
                <span class="dropdown-text">EDA</span></a>
                <a class="dropdown-item" href="../../technical-details/supervised-learning/main.html">
                  <span class="dropdown-text">Supervised-learning</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#instructions" id="toc-instructions" class="nav-link active" data-scroll-target="#instructions">Instructions</a></li>
  <li><a href="#data-collection" id="toc-data-collection" class="nav-link" data-scroll-target="#data-collection">EDA:</a>
  <ul class="collapse">
  <li><a href="#saving-the-raw-data" id="toc-saving-the-raw-data" class="nav-link" data-scroll-target="#saving-the-raw-data">Saving the raw data</a></li>
  <li><a href="#requirements" id="toc-requirements" class="nav-link" data-scroll-target="#requirements">Requirements:</a></li>
  </ul></li>
  <li><a href="#what-do-include-on-this-page" id="toc-what-do-include-on-this-page" class="nav-link" data-scroll-target="#what-do-include-on-this-page">What do include on this page</a></li>
  <li><a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods">Methods</a></li>
  <li><a href="#code" id="toc-code" class="nav-link" data-scroll-target="#code">Code</a>
  <ul class="collapse">
  <li><a href="#exmaple" id="toc-exmaple" class="nav-link" data-scroll-target="#exmaple">Exmaple</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">EDA</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<!-- After digesting the instructions, you can delete this cell, these are assignment instructions and do not need to be included in your final submission.  -->
<section id="instructions" class="level1">
<h1>Instructions</h1>
<p>On this page, you will focus on <strong>EDA</strong>, which is an essential step for future analysis. You should have already selected a specific data-science question that can be addressed in a data-driven way.</p>
<p>It is recommended that you focus on one or two of the following data format, <strong>text</strong>, <strong>tabular</strong>, <strong>image</strong>, <strong>geospatial</strong>, or <strong>network</strong> data.</p>
<p><strong>Tabular</strong> (e.g.&nbsp;CSV files) and <strong>text</strong> formats are highly recommended, as these are covered most thoroughly in the course. Deviating from these formats may require additional work on your end. Please avoid <strong>timeseries</strong> data formats, as these require special methods not covered in the course. You can include as many additional formats as you want. Your project will revolve around the data you gather and will include EDA, analysis, visualization, and storytelling.</p>
</section>
<section id="data-collection" class="level1">
<h1>EDA:</h1>
<p>Begin gathering your data and document the methods and sources on the <strong>EDA</strong> page of your project. Include screenshots to illustrate the EDA process without displaying entire datasets. Ensure <strong>transparency</strong> so anyone can replicate your work.</p>
<section id="saving-the-raw-data" class="level2">
<h2 class="anchored" data-anchor-id="saving-the-raw-data">Saving the raw data</h2>
<ul>
<li>During the collection phase, save the collected data locally to the <code>raw-data</code> folder, in the root of the project, for later processing.
<ul>
<li>Do not sync this folder to GitHub.</li>
</ul></li>
<li>You should also save files you download manually from online to this folder</li>
</ul>
</section>
<section id="requirements" class="level2">
<h2 class="anchored" data-anchor-id="requirements">Requirements:</h2>
<ul>
<li>Your data must be relevant to the project’s overall goals and help solve your research questions.</li>
<li>You must use <strong>at least one API</strong> to collect your data.</li>
<li>Ensure you have at least one <strong>regression target</strong>: a continuous quantity that can be used for regression prediction with other features.</li>
<li>Ensure you have at least one <strong>binary classification target</strong>: a two-class (A,B) label that can be predicted using other features.</li>
<li>Ensure you have at least one <strong>multi-classification target</strong>: a multi-class (A,B,C …) label that can be predicted using other features.</li>
<li><strong>Do not use a Kaggle topic</strong>—this project is meant to simulate a real-world project. Kaggle datasets are typically too clean and have already been prepped for analysis, which doesn’t align with the project’s goals.</li>
</ul>
<p>Remember, data is about <strong>quality</strong>, not quantity, so avoid handling large datasets unless necessary. Focus on data that tells a compelling story and supports the techniques you will apply (e.g., clustering, classification, regression).</p>
</section>
</section>
<section id="what-do-include-on-this-page" class="level1">
<h1>What do include on this page</h1>
<p>To ensure clarity and transparency throughout your project, your EDA documentation should include the following:</p>
<ol start="0" type="1">
<li><p><strong>Include all code used for EDA</strong> in the notebook below</p></li>
<li><p><strong>Data Source Information</strong></p>
<ul>
<li>Specify where the data comes from, whether public datasets, APIs, or original collection.</li>
<li>Provide links to datasets or API documentation and explain their relevance to the project.</li>
</ul></li>
<li><p><strong>EDA Methods</strong></p>
<ul>
<li>If you used an API or web scraping, explain the tools (e.g., <code>BeautifulSoup</code>, <code>Selenium</code>) and the process.</li>
<li>Include links to your code for replicating EDA.</li>
</ul></li>
<li><p><strong>Data Structure and Format</strong></p>
<ul>
<li>Describe the structure of your raw data (e.g., rows, columns, data types) and its format (CSV, JSON, etc.).</li>
</ul></li>
<li><p><strong>Linking to Data</strong></p>
<ul>
<li>Include links to the <strong>raw dataset</strong>, ensuring transparency and allowing replication.</li>
</ul></li>
<li><p><strong>Code and Reproducibility</strong></p>
<ul>
<li>Link to all relevant code, including EDA , with clear documentation to enable replication.</li>
</ul></li>
<li><p><strong>Transparency and Replicability</strong></p>
<ul>
<li>Ensure your entire workflow is transparent and reproducible by linking all data, code, and documentation. This allows others to follow your process from start to finish.</li>
</ul></li>
</ol>
</section>
<section id="methods" class="level1">
<h1>Methods</h1>
<p>Document an overview summary of the methods you used on this page</p>
</section>
<section id="code" class="level1">
<h1>Code</h1>
<p>Here you provide your source code used to do this section of the project</p>
<section id="exmaple" class="level2">
<h2 class="anchored" data-anchor-id="exmaple">Exmaple</h2>
<p>In the following code, we first utilized the requests library to retrieve the HTML content from the Wikipedia page. Afterward, we employed BeautifulSoup to parse the HTML and locate the specific table of interest by using the find function. Once the table was identified, we extracted the relevant data by iterating through its rows, gathering country names and their respective populations. Finally, we used Pandas to store the collected data in a DataFrame, allowing for easy analysis and visualization. The data could also be optionally saved as a CSV file for further use.<span class="citation" data-cites="gpt4o"><sup><a href="#ref-gpt4o" role="doc-biblioref">1</a></sup></span></p>
<div id="cell-6" class="cell" data-execution_count="2">
  <div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python">
  <span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas as pd</span>
  <span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
  
  <span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define paths to all cleaned data files</span></span>
  <span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>data_files = {</span>
  <span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    "Crude_Oil": "../../data/processed-data/Crude_Oil_cleaned.csv",</span>
  <span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    "Dow_Jones": "../../data/processed-data/Dow_Jones_cleaned.csv",</span>
  <span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    "Gold": "../../data/processed-data/Gold_cleaned.csv",</span>
  <span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    "Government_Spending": "../../data/processed-data/Government_Spending_Breakdown.csv",</span>
  <span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    "Macro_Series": "../../data/processed-data/macro_series_cleaned.csv",</span>
  <span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    "Nasdaq": "../../data/processed-data/Nasdaq_cleaned.csv",</span>
  <span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    "Personal_Info": "../../data/processed-data/personal_info_cleaned.csv",</span>
  <span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    "SP500": "../../data/processed-data/S&P_500_cleaned.csv",</span>
  <span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>}</span>
  
  <span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Verify file existence</span></span>
  <span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>for name, path in data_files.items():</span>
  <span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    if not os.path.exists(path):</span>
  <span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>        print(f"File not found: {path}")</span>
  
  <span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Load all datasets with error handling</span></span>
  <span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>dataframes = {}</span>
  <span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>for name, path in data_files.items():</span>
  <span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    try:</span>
  <span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>        dataframes[name] = pd.read_csv(path)</span>
  <span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>        print(f"{name} loaded successfully with shape: {dataframes[name].shape}")</span>
  <span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    except Exception as e:</span>
  <span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>        print(f"Failed to load {name}: {e}")</span>
  
  <span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate summary for each dataset</span></span>
  <span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>for name, df in dataframes.items():</span>
  <span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    print(f"\nTable: {name}")
  <span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    print("=" * 50)</span>
  <span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    print("\nBasic Info:")</span>
  <span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    print(df.info())</span>
  <span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    print("\nMissing Values:")</span>
  <span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    print(df.isnull().sum())</span>
  <span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    print("\nFirst 5 Rows:")</span>
  <span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    print(df.head())</span>
  <span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>    print("=" * 50)</span>
  </code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
  <div class="cell-output cell-output-stdout">
  </div>
  </div>
<pre><code> Crude_Oil loaded successfully with shape: (5847, 35)
  Dow_Jones loaded successfully with shape: (5858, 35)
  Gold loaded successfully with shape: (5843, 35)
  Government_Spending loaded successfully with shape: (95, 4)
  Macro_Series loaded successfully with shape: (299, 16)
  Nasdaq loaded successfully with shape: (5858, 35)
  Personal_Info loaded successfully with shape: (24, 11)
  SP500 loaded successfully with shape: (5858, 35)
  Table: Crude_Oil
  ==================================================
  Basic Info:
  <class 'pandas.core.frame.DataFrame'>
  RangeIndex: 5847 entries, 0 to 5846
  Data columns (total 35 columns):
   #   Column            Non-Null Count  Dtype  
  ---  ------            --------------  -----  
   0   index             5847 non-null   object 
   1   Open              5847 non-null   float64
   2   High              5847 non-null   float64
   3   Low               5847 non-null   float64
   4   Close             5847 non-null   float64
   5   Volume            5847 non-null   float64
   6   MA_50             5847 non-null   float64
   7   MA_200            5847 non-null   float64
   8   Daily_Return      5847 non-null   float64
   9   Volatility        5847 non-null   float64
   10  RSI               5847 non-null   float64
   11  EMA_12            5847 non-null   float64
   12  EMA_26            5847 non-null   float64
   13  MACD              5847 non-null   float64
   14  Signal_Line       5847 non-null   float64
   15  High_Low          5847 non-null   float64
   16  High_Close        5847 non-null   float64
   17  Low_Close         5847 non-null   float64
   18  True_Range        5847 non-null   float64
   19  ATR               5847 non-null   float64
   20  OBV               5847 non-null   float64
   21  RSI_Lag1          5847 non-null   float64
   22  MACD_Lag1         5847 non-null   float64
   23  Close_Lag1        5847 non-null   float64
   24  Volume_Lag1       5847 non-null   float64
   25  RSI_Lag2          5847 non-null   float64
   26  MACD_Lag2         5847 non-null   float64
   27  Close_Lag2        5847 non-null   float64
   28  Volume_Lag2       5847 non-null   float64
   29  RSI_Lag3          5847 non-null   float64
   30  MACD_Lag3         5847 non-null   float64
   31  Close_Lag3        5847 non-null   float64
   32  Volume_Lag3       5847 non-null   float64
   33  Target            5847 non-null   int64  
   34  Future_Return_5D  5847 non-null   float64
  dtypes: float64(33), int64(1), object(1)
  memory usage: 1.6+ MB
  None
  
  Missing Values:
  index               0
  Open                0
  High                0
  Low                 0
  Close               0
  Volume              0
  MA_50               0
  MA_200              0
  Daily_Return        0
  Volatility          0
  RSI                 0
  EMA_12              0
  EMA_26              0
  MACD                0
  Signal_Line         0
  High_Low            0
  High_Close          0
  Low_Close           0
  True_Range          0
  ATR                 0
  OBV                 0
  RSI_Lag1            0
  MACD_Lag1           0
  Close_Lag1          0
  Volume_Lag1         0
  RSI_Lag2            0
  MACD_Lag2           0
  Close_Lag2          0
  Volume_Lag2         0
  RSI_Lag3            0
  MACD_Lag3           0
  Close_Lag3          0
  Volume_Lag3         0
  Target              0
  Future_Return_5D    0
  dtype: int64
  
  First 5 Rows:
          index       Open       High        Low      Close   Volume    MA_50  \
  0  2001-08-20  26.650000  27.250000  26.350000  27.180000  53562.0  27.0530   
  1  2001-08-21  27.100000  28.100000  27.100000  27.850000  99270.0  27.0292   
  2  2001-08-22  27.120001  27.250000  26.350000  26.370001  93777.0  26.9730   
  3  2001-08-23  26.549999  26.719999  26.280001  26.629999  59594.0  26.9288   
  4  2001-08-24  26.700001  27.150000  26.629999  26.900000  79958.0  26.8860   
  
       MA_200  Daily_Return  Volatility  ...   RSI_Lag2  MACD_Lag2  Close_Lag2  \
  0  28.67190      0.020653    0.016879  ...  54.965368   0.262450   27.450001   
  1  28.64515      0.024650    0.017469  ...  50.000000   0.172104   26.629999   
  2  28.61430     -0.053142    0.019894  ...  58.250501   0.143235   27.180000   
  3  28.58445      0.009860    0.019879  ...  60.227278   0.172431   27.850000   
  4  28.55465      0.010139    0.019906  ...  38.487983   0.075278   26.370001   
  
     Volume_Lag2   RSI_Lag3  MACD_Lag3  Close_Lag3  Volume_Lag3  Target  \
  0      70918.0  59.201780   0.290454   27.559999      79697.0       0   
  1      61936.0  54.965368   0.262450   27.450001      70918.0       0   
  2      53562.0  50.000000   0.172104   26.629999      61936.0       1   
  3      99270.0  58.250501   0.143235   27.180000      53562.0       0   
  4      93777.0  60.227278   0.172431   27.850000      99270.0       1   
  
     Future_Return_5D  
  0         -0.018764  
  1         -0.024417  
  2          0.025787  
  3         -0.003004  
  4          0.011152  
  
  [5 rows x 35 columns]
  ==================================================
  Table: Dow_Jones
  ==================================================
  Basic Info:
  <class 'pandas.core.frame.DataFrame'>
  RangeIndex: 5858 entries, 0 to 5857
  Data columns (total 35 columns):
   #   Column            Non-Null Count  Dtype  
  ---  ------            --------------  -----  
   0   index             5858 non-null   object 
   1   Open              5858 non-null   float64
   2   High              5858 non-null   float64
   3   Low               5858 non-null   float64
   4   Close             5858 non-null   float64
   5   Volume            5858 non-null   float64
   6   MA_50             5858 non-null   float64
   7   MA_200            5858 non-null   float64
   8   Daily_Return      5858 non-null   float64
   9   Volatility        5858 non-null   float64
   10  RSI               5858 non-null   float64
   11  EMA_12            5858 non-null   float64
   12  EMA_26            5858 non-null   float64
   13  MACD              5858 non-null   float64
   14  Signal_Line       5858 non-null   float64
   15  High_Low          5858 non-null   float64
   16  High_Close        5858 non-null   float64
   17  Low_Close         5858 non-null   float64
   18  True_Range        5858 non-null   float64
   19  ATR               5858 non-null   float64
   20  OBV               5858 non-null   float64
   21  RSI_Lag1          5858 non-null   float64
   22  MACD_Lag1         5858 non-null   float64
   23  Close_Lag1        5858 non-null   float64
   24  Volume_Lag1       5858 non-null   float64
   25  RSI_Lag2          5858 non-null   float64
   26  MACD_Lag2         5858 non-null   float64
   27  Close_Lag2        5858 non-null   float64
   28  Volume_Lag2       5858 non-null   float64
   29  RSI_Lag3          5858 non-null   float64
   30  MACD_Lag3         5858 non-null   float64
   31  Close_Lag3        5858 non-null   float64
   32  Volume_Lag3       5858 non-null   float64
   33  Target            5858 non-null   int64  
   34  Future_Return_5D  5858 non-null   float64
  dtypes: float64(33), int64(1), object(1)
  memory usage: 1.6+ MB
  None
  
  Missing Values:
  index               0
  Open                0
  High                0
  Low                 0
  Close               0
  Volume              0
  MA_50               0
  MA_200              0
  Daily_Return        0
  Volatility          0
  RSI                 0
  EMA_12              0
  EMA_26              0
  MACD                0
  Signal_Line         0
  High_Low            0
  High_Close          0
  Low_Close           0
  True_Range          0
  ATR                 0
  OBV                 0
  RSI_Lag1            0
  MACD_Lag1           0
  Close_Lag1          0
  Volume_Lag1         0
  RSI_Lag2            0
  MACD_Lag2           0
  Close_Lag2          0
  Volume_Lag2         0
  RSI_Lag3            0
  MACD_Lag3           0
  Close_Lag3          0
  Volume_Lag3         0
  Target              0
  Future_Return_5D    0
  dtype: int64
  
  First 5 Rows:
          index          Open          High           Low         Close  \
  0  2001-08-17  10385.459961  10385.459961  10180.929688  10240.780273   
  1  2001-08-20  10239.330078  10320.070312  10210.480469  10320.070312   
  2  2001-08-21  10320.070312  10378.750000  10156.019531  10174.139648   
  3  2001-08-22  10170.299805  10305.129883  10134.500000  10276.900391   
  4  2001-08-23  10276.410156  10286.790039  10213.519531  10229.150391   
  
          Volume         MA_50        MA_200  Daily_Return  Volatility  ...  \
  0  217550000.0  10506.131543  10576.878877     -0.014601    0.009820  ...   
  1  180510000.0  10492.992949  10573.981880      0.007743    0.009888  ...   
  2  182840000.0  10478.033945  10570.450029     -0.014140    0.009985  ...   
  3  204500000.0  10464.604355  10567.744780      0.010100    0.010088  ...   
  4  153280000.0  10451.754961  10564.004482     -0.004646    0.009128  ...   
  
      RSI_Lag2  MACD_Lag2    Close_Lag2  Volume_Lag2   RSI_Lag3  MACD_Lag3  \
  0  43.098091 -41.864471  10345.950195  172000000.0  50.417576 -39.073852   
  1  48.494684 -39.858832  10392.519531  196520000.0  43.098091 -41.864471   
  2  41.429900 -49.937788  10240.780273  217550000.0  48.494684 -39.858832   
  3  38.701043 -50.940182  10320.070312  180510000.0  41.429900 -49.937788   
  4  33.700215 -62.786211  10174.139648  182840000.0  38.701043 -50.940182   
  
       Close_Lag3  Volume_Lag3  Target  Future_Return_5D  
  0  10412.169922  145780000.0       1          0.017810  
  1  10345.950195  172000000.0       1          0.006035  
  2  10392.519531  196520000.0       1          0.004707  
  3  10240.780273  217550000.0       0         -0.018099  
  4  10320.070312  180510000.0       0         -0.030264  
  
  [5 rows x 35 columns]
  ==================================================
  Table: Gold
  ==================================================
  Basic Info:
  <class 'pandas.core.frame.DataFrame'>
  RangeIndex: 5843 entries, 0 to 5842
  Data columns (total 35 columns):
   #   Column            Non-Null Count  Dtype  
  ---  ------            --------------  -----  
   0   index             5843 non-null   object 
   1   Open              5843 non-null   float64
   2   High              5843 non-null   float64
   3   Low               5843 non-null   float64
   4   Close             5843 non-null   float64
   5   Volume            5843 non-null   float64
   6   MA_50             5843 non-null   float64
   7   MA_200            5843 non-null   float64
   8   Daily_Return      5843 non-null   float64
   9   Volatility        5843 non-null   float64
   10  RSI               5843 non-null   float64
   11  EMA_12            5843 non-null   float64
   12  EMA_26            5843 non-null   float64
   13  MACD              5843 non-null   float64
   14  Signal_Line       5843 non-null   float64
   15  High_Low          5843 non-null   float64
   16  High_Close        5843 non-null   float64
   17  Low_Close         5843 non-null   float64
   18  True_Range        5843 non-null   float64
   19  ATR               5843 non-null   float64
   20  OBV               5843 non-null   float64
   21  RSI_Lag1          5843 non-null   float64
   22  MACD_Lag1         5843 non-null   float64
   23  Close_Lag1        5843 non-null   float64
   24  Volume_Lag1       5843 non-null   float64
   25  RSI_Lag2          5843 non-null   float64
   26  MACD_Lag2         5843 non-null   float64
   27  Close_Lag2        5843 non-null   float64
   28  Volume_Lag2       5843 non-null   float64
   29  RSI_Lag3          5843 non-null   float64
   30  MACD_Lag3         5843 non-null   float64
   31  Close_Lag3        5843 non-null   float64
   32  Volume_Lag3       5843 non-null   float64
   33  Target            5843 non-null   int64  
   34  Future_Return_5D  5843 non-null   float64
  dtypes: float64(33), int64(1), object(1)
  memory usage: 1.6+ MB
  None
  
  Missing Values:
  index               0
  Open                0
  High                0
  Low                 0
  Close               0
  Volume              0
  MA_50               0
  MA_200              0
  Daily_Return        0
  Volatility          0
  RSI                 0
  EMA_12              0
  EMA_26              0
  MACD                0
  Signal_Line         0
  High_Low            0
  High_Close          0
  Low_Close           0
  True_Range          0
  ATR                 0
  OBV                 0
  RSI_Lag1            0
  MACD_Lag1           0
  Close_Lag1          0
  Volume_Lag1         0
  RSI_Lag2            0
  MACD_Lag2           0
  Close_Lag2          0
  Volume_Lag2         0
  RSI_Lag3            0
  MACD_Lag3           0
  Close_Lag3          0
  Volume_Lag3         0
  Target              0
  Future_Return_5D    0
  dtype: int64
  
  First 5 Rows:
          index        Open        High         Low       Close  Volume  \
  0  2001-08-20  277.200012  277.200012  276.100006  276.100006     1.0   
  1  2001-08-21  275.000000  275.000000  275.000000  275.000000     2.0   
  2  2001-08-22  274.899994  274.899994  274.899994  274.899994     0.0   
  3  2001-08-23  275.299988  275.299988  275.299988  275.299988     0.0   
  4  2001-08-24  272.500000  272.500000  272.500000  272.500000    59.0   
  
          MA_50    MA_200  Daily_Return  Volatility  ...   RSI_Lag2  MACD_Lag2  \
  0  270.228000  266.9305     -0.011457    0.006771  ...  72.674576   1.746335   
  1  270.370001  266.9860     -0.003984    0.006825  ...  89.729877   2.169805   
  2  270.438000  267.0385     -0.000364    0.006708  ...  74.626993   2.221588   
  3  270.504000  267.0920      0.001455    0.006570  ...  69.000102   2.149091   
  4  270.448000  267.1320     -0.010171    0.006881  ...  68.656796   2.059823   
  
     Close_Lag2  Volume_Lag2   RSI_Lag3  MACD_Lag3  Close_Lag3  Volume_Lag3  \
  0  275.200012          6.0  76.536458   1.597883  275.700012          2.0   
  1  279.299988         26.0  72.674576   1.746335  275.200012          6.0   
  2  276.100006          1.0  89.729877   2.169805  279.299988         26.0   
  3  275.000000          2.0  74.626993   2.221588  276.100006          1.0   
  4  274.899994          0.0  69.000102   2.149091  275.000000          2.0   
  
     Target  Future_Return_5D  
  0       0         -0.012677  
  1       0         -0.009818  
  2       0         -0.004365  
  3       1          0.000363  
  4       1          0.006972  
  
  [5 rows x 35 columns]
  ==================================================
  Table: Government_Spending
  ==================================================
  Basic Info:
  <class 'pandas.core.frame.DataFrame'>
  RangeIndex: 95 entries, 0 to 94
  Data columns (total 4 columns):
   #   Column                                                                    Non-Null Count  Dtype
  ---  ------                                                                    --------------  -----
   0   TimePeriod                                                                95 non-null     int64
   1   Federal (Millions of $)                                                   95 non-null     int64
   2   Government consumption expenditures and gross investment (Millions of $)  95 non-null     int64
   3   State and local (Millions of $)                                           95 non-null     int64
  dtypes: int64(4)
  memory usage: 3.1 KB
  None
  
  Missing Values:
  TimePeriod                                                                  0
  Federal (Millions of $)                                                     0
  Government consumption expenditures and gross investment (Millions of $)    0
  State and local (Millions of $)                                             0
  dtype: int64
  
  First 5 Rows:
     TimePeriod  Federal (Millions of $)  \
  0        1929                     1907   
  1        1930                     2017   
  2        1931                     2067   
  3        1932                     2006   
  4        1933                     2458   
  
     Government consumption expenditures and gross investment (Millions of $)  \
  0                                               9622                          
  1                                              10273                          
  2                                              10169                          
  3                                               8946                          
  4                                               8875                          
  
     State and local (Millions of $)  
  0                             7714  
  1                             8256  
  2                             8102  
  3                             6940  
  4                             6417  
  ==================================================
  Table: Macro_Series
  ==================================================
  Basic Info:
  <class 'pandas.core.frame.DataFrame'>
  RangeIndex: 299 entries, 0 to 298
  Data columns (total 16 columns):
   #   Column        Non-Null Count  Dtype  
  ---  ------        --------------  -----  
   0   date          299 non-null    object 
   1   GDP           299 non-null    float64
   2   CPI           299 non-null    float64
   3   Unemployment  299 non-null    float64
   4   FedFundsRate  299 non-null    float64
   5   M2            298 non-null    float64
   6   Umscent       299 non-null    float64
   7   real_estate   297 non-null    float64
   8   Exports       299 non-null    float64
   9   Imports       299 non-null    float64
   10  year          299 non-null    int64  
   11  GDP_YoY       299 non-null    float64
   12  GDP_MoM       299 non-null    float64
   13  CPI_YoY       299 non-null    float64
   14  GDP_Lag1      299 non-null    float64
   15  CPI_Lag1      299 non-null    float64
  dtypes: float64(14), int64(1), object(1)
  memory usage: 37.5+ KB
  None
  
  Missing Values:
  date            0
  GDP             0
  CPI             0
  Unemployment    0
  FedFundsRate    0
  M2              1
  Umscent         0
  real_estate     2
  Exports         0
  Imports         0
  year            0
  GDP_YoY         0
  GDP_MoM         0
  CPI_YoY         0
  GDP_Lag1        0
  CPI_Lag1        0
  dtype: int64
  
  First 5 Rows:
           date        GDP    CPI  Unemployment  FedFundsRate      M2  Umscent  \
  0  2000-01-01  10002.179  169.3           4.0          5.45  4667.6    112.0   
  1  2000-02-01  10250.952  170.0           4.1          5.73  4680.9    111.3   
  2  2000-03-01  10250.952  171.0           4.0          5.85  4711.7    107.1   
  3  2000-04-01  10247.720  170.9           3.8          6.02  4767.8    109.2   
  4  2000-05-01  10250.952  171.2           4.0          6.27  4755.7    110.7   
  
     real_estate     Exports   Imports  year   GDP_YoY   GDP_MoM   CPI_YoY  \
  0      100.000  1052.90400  1409.487  2000  0.062741  0.038522  0.027930   
  1      100.571  1096.11075  1477.184  2000  0.064351  0.024872  0.032180   
  2      101.466  1096.11075  1477.184  2000  0.064351  0.000000  0.037621   
  3      102.541  1093.36000  1455.860  2000  0.075739 -0.000315  0.030139   
  4      103.702  1096.11075  1477.184  2000  0.064351  0.000315  0.031325   
  
        GDP_Lag1  CPI_Lag1  
  0   9631.17175     168.8  
  1  10002.17900     169.3  
  2  10250.95200     170.0  
  3  10250.95200     171.0  
  4  10247.72000     170.9  
  ==================================================
  Table: Nasdaq
  ==================================================
  Basic Info:
  <class 'pandas.core.frame.DataFrame'>
  RangeIndex: 5858 entries, 0 to 5857
  Data columns (total 35 columns):
   #   Column            Non-Null Count  Dtype  
  ---  ------            --------------  -----  
   0   index             5858 non-null   object 
   1   Open              5858 non-null   float64
   2   High              5858 non-null   float64
   3   Low               5858 non-null   float64
   4   Close             5858 non-null   float64
   5   Volume            5858 non-null   float64
   6   MA_50             5858 non-null   float64
   7   MA_200            5858 non-null   float64
   8   Daily_Return      5858 non-null   float64
   9   Volatility        5858 non-null   float64
   10  RSI               5858 non-null   float64
   11  EMA_12            5858 non-null   float64
   12  EMA_26            5858 non-null   float64
   13  MACD              5858 non-null   float64
   14  Signal_Line       5858 non-null   float64
   15  High_Low          5858 non-null   float64
   16  High_Close        5858 non-null   float64
   17  Low_Close         5858 non-null   float64
   18  True_Range        5858 non-null   float64
   19  ATR               5858 non-null   float64
   20  OBV               5858 non-null   float64
   21  RSI_Lag1          5858 non-null   float64
   22  MACD_Lag1         5858 non-null   float64
   23  Close_Lag1        5858 non-null   float64
   24  Volume_Lag1       5858 non-null   float64
   25  RSI_Lag2          5858 non-null   float64
   26  MACD_Lag2         5858 non-null   float64
   27  Close_Lag2        5858 non-null   float64
   28  Volume_Lag2       5858 non-null   float64
   29  RSI_Lag3          5858 non-null   float64
   30  MACD_Lag3         5858 non-null   float64
   31  Close_Lag3        5858 non-null   float64
   32  Volume_Lag3       5858 non-null   float64
   33  Target            5858 non-null   int64  
   34  Future_Return_5D  5858 non-null   float64
  dtypes: float64(33), int64(1), object(1)
  memory usage: 1.6+ MB
  None
  
  Missing Values:
  index               0
  Open                0
  High                0
  Low                 0
  Close               0
  Volume              0
  MA_50               0
  MA_200              0
  Daily_Return        0
  Volatility          0
  RSI                 0
  EMA_12              0
  EMA_26              0
  MACD                0
  Signal_Line         0
  High_Low            0
  High_Close          0
  Low_Close           0
  True_Range          0
  ATR                 0
  OBV                 0
  RSI_Lag1            0
  MACD_Lag1           0
  Close_Lag1          0
  Volume_Lag1         0
  RSI_Lag2            0
  MACD_Lag2           0
  Close_Lag2          0
  Volume_Lag2         0
  RSI_Lag3            0
  MACD_Lag3           0
  Close_Lag3          0
  Volume_Lag3         0
  Target              0
  Future_Return_5D    0
  dtype: int64
  
  First 5 Rows:
          index         Open         High          Low        Close  \
  0  2001-08-17  1895.420044  1903.729980  1862.760010  1867.010010   
  1  2001-08-20  1866.290039  1881.619995  1854.959961  1881.349976   
  2  2001-08-21  1883.439941  1893.390015  1831.280029  1831.300049   
  3  2001-08-22  1851.750000  1860.020020  1817.699951  1860.010010   
  4  2001-08-23  1857.520020  1883.479980  1842.510010  1842.969971   
  
           Volume        MA_50       MA_200  Daily_Return  Volatility  ...  \
  0  1.301510e+09  2037.583804  2314.628695     -0.032798    0.019187  ...   
  1  1.165790e+09  2030.908801  2307.368495      0.007681    0.019112  ...   
  2  1.325960e+09  2024.119202  2299.379896     -0.026603    0.018871  ...   
  3  1.550540e+09  2017.920403  2291.422045      0.015677    0.019113  ...   
  4  1.456290e+09  2012.346604  2283.555845     -0.009161    0.016154  ...   
  
      RSI_Lag2  MACD_Lag2   Close_Lag2   Volume_Lag2   RSI_Lag3  MACD_Lag3  \
  0  33.046621 -26.765509  1918.890015  1.463930e+09  46.700909 -22.072858   
  1  34.187338 -29.225278  1930.319946  1.613790e+09  33.046621 -26.765509   
  2  29.300349 -35.869762  1867.010010  1.301510e+09  34.187338 -29.225278   
  3  30.266911 -39.522852  1881.349976  1.165790e+09  29.300349 -35.869762   
  4  18.655134 -45.927144  1831.300049  1.325960e+09  30.266911 -39.522852   
  
      Close_Lag3   Volume_Lag3  Target  Future_Return_5D  
  0  1964.530029  1.231860e+09       1          0.026668  
  1  1918.890015  1.463930e+09       1          0.016509  
  2  1930.319946  1.613790e+09       1          0.018391  
  3  1867.010010  1.301510e+09       0         -0.009054  
  4  1881.349976  1.165790e+09       0         -0.027830  
  
  [5 rows x 35 columns]
  ==================================================
  Table: Personal_Info
  ==================================================
  Basic Info:
  <class 'pandas.core.frame.DataFrame'>
  RangeIndex: 24 entries, 0 to 23
  Data columns (total 11 columns):
   #   Column                                                                                   Non-Null Count  Dtype  
  ---  ------                                                                                   --------------  -----  
   0   TimePeriod                                                                               24 non-null     int64  
   1   Disposable personal income, chained (2017) dollars                                       24 non-null     float64
   2   Disposable personal income, current dollars                                              24 non-null     float64
   3   Disposable_Income (Millions of $)                                                        24 non-null     float64
   4   Personal_Saving (Millions of $)                                                          24 non-null     float64
   5   Personal_Taxes (Millions of $)                                                           24 non-null     float64
   6   Consumption_Expenditures (Millions of $)                                                 24 non-null     float64
   7   Personal_Income (Millions of $)                                                          24 non-null     float64
   8   Personal income excluding current transfer receipts, Billions of chained (2017) dollars  24 non-null     float64
   9   Personal income receipts on assets                                                       24 non-null     float64
   10  Saving_Rate (%)                                                                          24 non-null     float64
  dtypes: float64(10), int64(1)
  memory usage: 2.2 KB
  None
  
  Missing Values:
  TimePeriod                                                                                 0
  Disposable personal income, chained (2017) dollars                                         0
  Disposable personal income, current dollars                                                0
  Disposable_Income (Millions of $)                                                          0
  Personal_Saving (Millions of $)                                                            0
  Personal_Taxes (Millions of $)                                                             0
  Consumption_Expenditures (Millions of $)                                                   0
  Personal_Income (Millions of $)                                                            0
  Personal income excluding current transfer receipts, Billions of chained (2017) dollars    0
  Personal income receipts on assets                                                         0
  Saving_Rate (%)                                                                            0
  dtype: int64
  
  First 5 Rows:
     TimePeriod  Disposable personal income, chained (2017) dollars  \
  0        2000                                                4.9    
  1        2001                                                2.9    
  2        2002                                                3.1    
  3        2003                                                2.5    
  4        2004                                                3.2    
  
     Disposable personal income, current dollars  \
  0                                          7.5   
  1                                          5.0   
  2                                          4.4   
  3                                          4.7   
  4                                          5.8   
  
     Disposable_Income (Millions of $)  Personal_Saving (Millions of $)  \
  0                          7384970.0                         316823.0   
  1                          7754096.0                         363156.0   
  2                          8097871.0                         451596.0   
  3                          8478217.0                         439894.0   
  4                          8967128.0                         417049.0   
  
     Personal_Taxes (Millions of $)  Consumption_Expenditures (Millions of $)  \
  0                       1236329.0                                 6767179.0   
  1                       1239047.0                                 7073801.0   
  2                       1052178.0                                 7348941.0   
  3                       1003538.0                                 7740749.0   
  4                       1048745.0                                 8231960.0   
  
     Personal_Income (Millions of $)  \
  0                        8621299.0   
  1                        8993143.0   
  2                        9150049.0   
  3                        9481755.0   
  4                       10015873.0   
  
     Personal income excluding current transfer receipts, Billions of chained (2017) dollars  \
  0                                         10205604.0                                         
  1                                         10358990.0                                         
  2                                         10308983.0                                         
  3                                         10443064.0                                         
  4                                         10766533.0                                         
  
     Personal income receipts on assets  Saving_Rate (%)  
  0                           1455648.0              4.3  
  1                           1461935.0              4.7  
  2                           1402632.0              5.6  
  3                           1435569.0              5.2  
  4                           1498706.0              4.7  
  ==================================================
  Table: SP500
  ==================================================
  Basic Info:
  <class 'pandas.core.frame.DataFrame'>
  RangeIndex: 5858 entries, 0 to 5857
  Data columns (total 35 columns):
   #   Column            Non-Null Count  Dtype  
  ---  ------            --------------  -----  
   0   index             5858 non-null   object 
   1   Open              5858 non-null   float64
   2   High              5858 non-null   float64
   3   Low               5858 non-null   float64
   4   Close             5858 non-null   float64
   5   Volume            5858 non-null   float64
   6   MA_50             5858 non-null   float64
   7   MA_200            5858 non-null   float64
   8   Daily_Return      5858 non-null   float64
   9   Volatility        5858 non-null   float64
   10  RSI               5858 non-null   float64
   11  EMA_12            5858 non-null   float64
   12  EMA_26            5858 non-null   float64
   13  MACD              5858 non-null   float64
   14  Signal_Line       5858 non-null   float64
   15  High_Low          5858 non-null   float64
   16  High_Close        5858 non-null   float64
   17  Low_Close         5858 non-null   float64
   18  True_Range        5858 non-null   float64
   19  ATR               5858 non-null   float64
   20  OBV               5858 non-null   float64
   21  RSI_Lag1          5858 non-null   float64
   22  MACD_Lag1         5858 non-null   float64
   23  Close_Lag1        5858 non-null   float64
   24  Volume_Lag1       5858 non-null   float64
   25  RSI_Lag2          5858 non-null   float64
   26  MACD_Lag2         5858 non-null   float64
   27  Close_Lag2        5858 non-null   float64
   28  Volume_Lag2       5858 non-null   float64
   29  RSI_Lag3          5858 non-null   float64
   30  MACD_Lag3         5858 non-null   float64
   31  Close_Lag3        5858 non-null   float64
   32  Volume_Lag3       5858 non-null   float64
   33  Target            5858 non-null   int64  
   34  Future_Return_5D  5858 non-null   float64
  dtypes: float64(33), int64(1), object(1)
  memory usage: 1.6+ MB
  None
  
  Missing Values:
  index               0
  Open                0
  High                0
  Low                 0
  Close               0
  Volume              0
  MA_50               0
  MA_200              0
  Daily_Return        0
  Volatility          0
  RSI                 0
  EMA_12              0
  EMA_26              0
  MACD                0
  Signal_Line         0
  High_Low            0
  High_Close          0
  Low_Close           0
  True_Range          0
  ATR                 0
  OBV                 0
  RSI_Lag1            0
  MACD_Lag1           0
  Close_Lag1          0
  Volume_Lag1         0
  RSI_Lag2            0
  MACD_Lag2           0
  Close_Lag2          0
  Volume_Lag2         0
  RSI_Lag3            0
  MACD_Lag3           0
  Close_Lag3          0
  Volume_Lag3         0
  Target              0
  Future_Return_5D    0
  dtype: int64
  
  First 5 Rows:
          index         Open         High          Low        Close  \
  0  2001-08-17  1181.660034  1181.660034  1156.069946  1161.969971   
  1  2001-08-20  1161.969971  1171.410034  1160.939941  1171.410034   
  2  2001-08-21  1171.410034  1179.849976  1156.560059  1157.260010   
  3  2001-08-22  1157.260010  1168.560059  1153.339966  1165.310059   
  4  2001-08-23  1165.310059  1169.859985  1160.959961  1162.089966   
  
           Volume        MA_50       MA_200  Daily_Return  Volatility  ...  \
  0  9.743000e+08  1209.214399  1265.023450     -0.016663    0.010108  ...   
  1  8.971000e+08  1207.343401  1263.774400      0.008124    0.010143  ...   
  2  1.041600e+09  1205.400801  1262.419100     -0.012079    0.010043  ...   
  3  1.110800e+09  1203.590002  1261.112201      0.006956    0.010138  ...   
  4  9.862000e+08  1201.999802  1259.761701     -0.002763    0.009066  ...   
  
      RSI_Lag2  MACD_Lag2   Close_Lag2   Volume_Lag2   RSI_Lag3  MACD_Lag3  \
  0  35.635982  -7.692323  1178.020020  1.065600e+09  47.921267  -6.768922   
  1  36.188016  -8.037752  1181.660034  1.055400e+09  35.635982  -7.692323   
  2  29.900799  -9.787506  1161.969971  9.743000e+08  36.188016  -8.037752   
  3  31.663348 -10.293803  1171.410034  8.971000e+08  29.900799  -9.787506   
  4  25.146163 -11.701944  1157.260010  1.041600e+09  31.663348 -10.293803   
  
      Close_Lag3   Volume_Lag3  Target  Future_Return_5D  
  0  1186.729980  9.646000e+08       1          0.019760  
  1  1178.020020  1.065600e+09       1          0.006659  
  2  1181.660034  1.055400e+09       1          0.003672  
  3  1161.969971  9.743000e+08       0         -0.014374  
  4  1171.410034  8.971000e+08       0         -0.028449  
  
  [5 rows x 35 columns]
  ==================================================
</code></pre>

<div id="cell-6" class="cell" data-execution_count="2">
  <div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python">
  <span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot as plt</span>
  <span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn as sns</span>
  <span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
  <span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
  
  <span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to plot and save distributions</span></span>
  <span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>def plot_distributions(df, table_name, save_path):</span>
  <span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create save directory</span></span>
  <span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    os.makedirs(save_path, exist_ok=True)</span>
     
  <span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get numerical columns and setup plot grid</span></span>
  <span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    numerical_columns = df.select_dtypes(include=['float64', 'int64']).columns</span>
  <span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    n_cols = 3</span>
  <span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    n_rows = math.ceil(len(numerical_columns) / n_cols)</span>
  <span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    fig, axes = plt.subplots(n_rows, n_cols, figsize=(15, n_rows * 5))</span>
  <span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    fig.suptitle(f"{table_name}: Numerical Features Distribution", fontsize=16)</span>
     
  <span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Handle single row case</span></span>
  <span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    if n_rows == 1:</span>
  <span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>        axes = axes.reshape(1, -1)</span>
     
  <span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create distribution plots</span></span>
  <span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    for i, col in enumerate(numerical_columns):</span>
  <span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>        row, col_pos = divmod(i, n_cols)</span>
  <span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>        sns.histplot(</span>
  <span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>            data=df,</span>
  <span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>            x=col,</span>
  <span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>            kde=True,</span>
  <span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>            bins=30,</span>
  <span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>            ax=axes[row, col_pos],</span>
  <span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>            color='blue',</span>
  <span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>            edgecolor='black'</span>
  <span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>        )</span>
  <span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>        axes[row, col_pos].set_title(f"Distribution of {col}")</span>
  <span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>        axes[row, col_pos].set_xlabel(col)</span>
  <span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>        axes[row, col_pos].set_ylabel("Frequency")</span>
     
  <span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove empty subplots</span></span>
  <span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>    for j in range(i + 1, n_rows * n_cols):</span>
  <span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>        row, col_pos = divmod(j, n_cols)</span>
  <span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>        fig.delaxes(axes[row, col_pos])</span>
     
  <span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout(rect=[0, 0, 1, 0.95])</span>
     
  <span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Save and close plot</span></span>
  <span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>    save_file = os.path.join(save_path, f"{table_name}_distributions.png")</span>
  <span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>    plt.savefig(save_file, dpi=300, bbox_inches='tight')</span>
  <span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>    plt.close()</span>
  <span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>    print(f"Saved plot to: {save_file}")</span>
  
  <span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Set save path and generate plots</span></span>
  <span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>save_path = "/Users/qqmian/Desktop/GU_5000/Stock_Market_Performance/data/visualized-data"</span>
  
  <span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>for name, df in dataframes.items():</span>
  <span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>    print(f"Analyzing {name}")</span>
  <span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>    plot_distributions(df, name, save_path)</span>
  </code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
  <div class="cell-output cell-output-stdout">
  </div>
  </div>
    
    <div class="image-container">
        <img src="../../assets/Crude_Oil_distributions.png" class="distribution-image" alt="Crude Oil Distributions" />
        <img src="../../assets/Dow_Jones_distributions.png" class="distribution-image" alt="Dow Jones Distributions" />
        <img src="../../assets/Gold_distributions.png" class="distribution-image" alt="Gold Distributions" />
        <img src="../../assets/Government_Spending_distributions.png" class="distribution-image" alt="Government Spending Distributions" />
        <img src="../../assets/Macro_Series_distributions.png" class="distribution-image" alt="Macro Series Distributions" />
        <img src="../../assets/Nasdaq_distributions.png" class="distribution-image" alt="Nasdaq Distributions" />
        <img src="../../assets/Personal_Info_distributions.png" class="distribution-image" alt="Personal Info Distributions" />
        <img src="../../assets/SP500_distributions.png" class="distribution-image" alt="SP500 Distributions" />

    </div>
    <div id="cell-6" class="cell" data-execution_count="2">
      <div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python">
      
      <span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to plot and save correlation heatmaps</span></span>
      <span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>def plot_correlation_heatmap(df, table_name, save_path):</span>
      <span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create save directory</span></span>
      <span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    os.makedirs(save_path, exist_ok=True)</span>
         
      <span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get numerical columns</span></span>
      <span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    numerical_columns = df.select_dtypes(include=['float64', 'int64']).columns</span>
      <span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    if len(numerical_columns) == 0:</span>
      <span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>        print(f"No numerical columns in {table_name}")</span>
      <span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>        return</span>
      
      <span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Compute correlation matrix</span></span>
      <span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    corr_matrix = df[numerical_columns].corr()</span>
         
      <span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create heatmap</span></span>
      <span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize=(16, 12))</span>
      <span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    heatmap = sns.heatmap(</span>
      <span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>        corr_matrix,</span>
      <span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>        annot=True,</span>
      <span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>        fmt=".2f",</span>
      <span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>        cmap="coolwarm",</span>
      <span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>        linewidths=0.5,</span>
      <span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>        annot_kws={"size": 10}</span>
      <span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    )</span>
         
      <span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Configure plot appearance</span></span>
      <span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    plt.title(f"Correlation Heatmap for {table_name}", fontsize=16)</span>
      <span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    plt.xticks(rotation=45, fontsize=10, ha='right')</span>
      <span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    plt.yticks(rotation=0, fontsize=10)</span>
      <span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
         
      <span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Save and close plot</span></span>
      <span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    save_file = os.path.join(save_path, f"{table_name}_correlation_heatmap.png")</span>
      <span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    plt.savefig(save_file, dpi=300, bbox_inches='tight')</span>
      <span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    plt.close()</span>
      <span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    print(f"Saved correlation heatmap to: {save_file}")</span>
      
      <span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Set save path</span></span>
      <span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>save_path = "/Users/qqmian/Desktop/GU_5000/Stock_Market_Performance/data/visualized-data"</span>
      
      <span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data if not already loaded</span></span>
      <span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>if 'dataframes' not in locals():</span>
      <span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>    dataframes = {}</span>
      <span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>    data_path = "/Users/qqmian/Desktop/GU_5000/Stock_Market_Performance/data"</span>
      <span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>    for file in os.listdir(data_path):</span>
      <span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>        if file.endswith('.csv'):</span>
      <span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>            name = os.path.splitext(file)[0]</span>
      <span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>            file_path = os.path.join(data_path, file)</span>
      <span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>            dataframes[name] = pd.read_csv(file_path)</span>
      <span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>            print(f"Loaded {file}")</span>
      
      <span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate heatmaps</span></span>
      <span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>for name, df in dataframes.items():</span>
      <span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>    print(f"\nAnalyzing correlation for {name}")</span>
      <span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>    plot_correlation_heatmap(df, name, save_path)</span>
      </code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
      <div class="cell-output cell-output-stdout">
      </div>
      </div>
      <div class="image-container">
        <img src="../../assets/Crude_Oil_correlation_heatmap.png" class="distribution-image" alt="Crude Oil correlation_heatmap" />
        <img src="../../assets/Dow_Jones_correlation_heatmap.png" class="distribution-image" alt="Dow Jones correlation_heatmap" />
        <img src="../../assets/Gold_correlation_heatmap.png" class="distribution-image" alt="Gold correlation_heatmap" />
        <img src="../../assets/Government_Spending_correlation_heatmap.png" class="distribution-image" alt="Government Spending correlation_heatmap" />
        <img src="../../assets/Macro_Series_correlation_heatmap.png" class="distribution-image" alt="Macro Series correlation_heatmap" />
        <img src="../../assets/Nasdaq_correlation_heatmap.png" class="distribution-image" alt="Nasdaq correlation_heatmap" />
        <img src="../../assets/Personal_Info_correlation_heatmap.png" class="distribution-image" alt="Personal Info correlation_heatmap" />
        <img src="../../assets/SP500_correlation_heatmap.png" class="distribution-image" alt="SP500 correlation_heatmap" />

    </div>


    <div id="cell-6" class="cell" data-execution_count="2">
      <div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python">
      
      <span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn as sns</span>
      <span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot as plt</span>
      <span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
      
      <span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to plot target variable distribution</span></span>
      <span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>def plot_target_distribution(df, save_path):</span>
      <span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create save directory</span></span>
      <span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    os.makedirs(save_path, exist_ok=True)</span>
         
      <span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create count plot</span></span>
      <span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize=(10, 6))</span>
      <span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    sns.countplot(x='Target', data=df, palette='coolwarm')</span>
      <span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    plt.title('Distribution of Target (Price Direction)', fontsize=14)</span>
      <span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    plt.xlabel('Target (0: Down, 1: Up)', fontsize=12)</span>
      <span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    plt.ylabel('Count', fontsize=12)</span>
         
      <span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add count labels</span></span>
      <span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    for i in plt.gca().containers:</span>
      <span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>        plt.gca().bar_label(i)</span>
         
      <span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add percentage labels</span></span>
      <span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    total = len(df)</span>
      <span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    for i, count in enumerate(df['Target'].value_counts()):</span>
      <span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>        percentage = count/total * 100</span>
      <span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>        plt.text(i, count, f'\n{percentage:.1f}%',</span>
      <span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>                horizontalalignment='center',</span>
      <span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>                fontsize=10)</span>
         
      <span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    plt.tight_layout()</span>
         
      <span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Save plot</span></span>
      <span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    save_file = os.path.join(save_path, 'target_distribution.png')</span>
      <span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    plt.savefig(save_file, dpi=300, bbox_inches='tight')</span>
      <span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>    plt.close()</span>
      <span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    print(f"Saved target distribution plot to: {save_file}")</span>
         
      <span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Print distribution summary</span></span>
      <span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    print("\nTarget Distribution Summary:")</span>
      <span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    print(df['Target'].value_counts(normalize=True).round(3) * 100)</span>
      
      <span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Set save path and generate plot</span></span>
      <span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>save_path = "/Users/qqmian/Desktop/GU_5000/Stock_Market_Performance/data/visualized-data"</span>
      <span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>plot_target_distribution(df, save_path)</span>
      </code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
      <div class="cell-output cell-output-stdout">
      </div>
      </div>
      <pre><code>Target Distribution Summary:
        Target
        1    57.9
        0    42.1    
      </code></pre>  

      <div class="image-container">
        <img src="../../assets/target_distribution.png" class="distribution-image" alt="Target Distribution" />
    </div>
    <div id="cell-6" class="cell" data-execution_count="2">
      <div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python">
      
      <span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn as sns</span>
      <span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot as plt</span>
      <span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> os</span>
      
      <span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create directory for saving visualizations</span></span>
      <span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>save_path = "/Users/qqmian/Desktop/GU_5000/Stock_Market_Performance/data/visualized-data"</span>
      <span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>os.makedirs(save_path, exist_ok=True)</span>
      
      <span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Define key features to analyze</span></span>
      <span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>top_features = ['Future_Return_5D', 'Volatility', 'MACD', 'Signal_Line', 'RSI']</span>
      
      <span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create boxplots</span></span>
      <span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>for feature in top_features:</span>
      <span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize=(8, 5))</span>
      <span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    sns.boxplot(x='Target', y=feature, data=df, palette='pastel')</span>
      <span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    plt.title(f'Boxplot of {feature} by Target')</span>
      <span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    save_file = os.path.join(save_path, f'{feature}_boxplot.png')</span>
      <span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    plt.savefig(save_file, dpi=300, bbox_inches='tight')</span>
      <span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
      <span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    plt.close()</span>
      
      <span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Create density plots</span></span>
      <span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>for feature in top_features:</span>
      <span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize=(8, 5))</span>
      <span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    sns.kdeplot(data=df, x=feature, hue='Target', fill=True, </span>
      <span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>               common_norm=False, palette='muted')</span>
      <span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>    plt.title(f'Density Plot of {feature} by Target')</span>
      <span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    save_file = os.path.join(save_path, f'{feature}_density.png')</span>
      <span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>    plt.savefig(save_file, dpi=300, bbox_inches='tight')</span>
      <span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
      <span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    plt.close()</span>
      </code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
      <div class="cell-output cell-output-stdout">
      </div>
      </div>
      <div class="image-container">
        <img src="../../assets/Future_Return_5D_boxplot.png" class="distribution-image" alt="Future Return 5D boxplot" />
        <img src="../../assets/Future_Return_5D_density.png" class="distribution-image" alt="Future Return 5D density" />
        <img src="../../assets/MACD_boxplot.png" class="distribution-image" alt="MACD boxplot" />
        <img src="../../assets/MACD_density.png" class="distribution-image" alt="MACD density" />
        <img src="../../assets/RSI_boxplot.png" class="distribution-image" alt="RSI boxplot" />
        <img src="../../assets/RSI_density.png" class="distribution-image" alt="RSI density" />
        <img src="../../assets/Signal_Line_boxplot.png" class="distribution-image" alt="Signal Line boxplot" />
        <img src="../../assets/Signal_Line_density.png" class="distribution-image" alt="Signal Line density" />
        <img src="../../assets/Volatility_boxplot.png" class="distribution-image" alt="Volatility boxplot" />
        <img src="../../assets/Volatility_density.png" class="distribution-image" alt="Volatility density" />

    </div>
    <div id="cell-6" class="cell" data-execution_count="2">
      <div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python">
      
    <span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats import ttest_ind</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas as pd</span>

<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Set target variable</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>target_column = 'Target'</span>

<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Store t-test results</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>t_test_results = []</span>

<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform t-tests for each dataset</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>for name, df in dataframes.items():</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    if target_column not in df.columns:</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>        print(f"{name} does not contain {target_column}, skipping...")</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>        continue</span>

<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get numerical columns</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    numerical_columns = df.select_dtypes(include=['float64', 'int64']).columns</span>
    
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Test each feature</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    for col in numerical_columns:</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>        group0 = df[df[target_column] == 0][col]</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>        group1 = df[df[target_column] == 1][col]</span>
        
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculate t-test</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>        t_stat, p_value = ttest_ind(group0, group1, equal_var=False)</span>
        
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Store results</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>        t_test_results.append({</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>            "Table": name,</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>            "Feature": col,</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>            "t-statistic": t_stat,</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>            "p-value": p_value</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>        })</span>

<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Create results DataFrame</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>t_test_df = pd.DataFrame(t_test_results)</span>

<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter significant results</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>significant_features = t_test_df[t_test_df['p-value'] < 0.05]</span>

<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort and display results</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>significant_features = significant_features.sort_values(by='p-value')</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>print("Significant Features:")</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>print(significant_features)</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
  <pre><code>Significant Features:
    Table           Feature  t-statistic   p-value
  169      SP500  Future_Return_5D   -71.606147  0.000000
  32   Crude_Oil            Target         -inf  0.000000
  135     Nasdaq  Future_Return_5D   -80.888599  0.000000
  33   Crude_Oil  Future_Return_5D   -52.942045  0.000000
  134     Nasdaq            Target         -inf  0.000000
  ..         ...               ...          ...       ...
  74        Gold            MA_200     2.100906  0.035694
  73        Gold             MA_50     2.094097  0.036296
  167      SP500       Volume_Lag3    -2.079218  0.037647
  16   Crude_Oil         Low_Close     1.995997  0.045981
  15   Crude_Oil        High_Close     1.966614  0.049275
  
  [73 rows x 4 columns]</code></pre>
</div>
</div>

  </div>

</div>

</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-gpt4o" class="csl-entry" role="listitem">
<div class="csl-left-margin">1. </div><div class="csl-right-inline">ChatGPT, version-4o, OpenAI, may-13, 2024, chat.openai.com.</div>
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>